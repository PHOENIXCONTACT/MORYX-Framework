@if (displayedInstruction()) {
  <div class="scaling" (swipeleft)="onSwipeLeft()"
    (swiperight)="onSwipeRight()">
    <mat-card class="container">
      <div class="content">
        @if (mediaItemsContent().length) {
          <media-contents [displayedContents]="mediaItemsContent()"
            class="media-instructions-container">
          </media-contents>
        }
        @if ((textItems().length || inputs()) && mediaItemsContent().length) {
          <button class="fullscreen hover-button" mat-mini-fab
            aria-label="fullscreen" (click)="toggleFullscreen()">
            <span class="material-symbols-outlined">fullscreen</span>
          </button>
        }
        @if (textItems().length && mediaItems().length && !instructionStateService.fullscreen()) {
          <mat-divider vertical></mat-divider>
        }
        @if (textItems().length && !instructionStateService.fullscreen()) {
          <div class="text-instruction-container">
            <mat-card-title class="card-title">{{ displayedInstruction()?.sender }}</mat-card-title>
            <mat-card-content class="card-content">
              @for (item of textItems(); track item) {
                <div>
                  <markdown [data]="item.content"  [disableSanitizer]="true"></markdown>
                </div>
              }
            </mat-card-content>
            @if (inputs()) {
              <div class="input-instructions">
                <navigable-entry-editor [disabled]="false" [entry]="inputs()!"></navigable-entry-editor>
              </div>
            }
          </div>
        }
      </div>
      <mat-card-actions class="card-action-buttons"
        >
        @if ((instructions().length > 1)) {
          <div class="carousel-buttons">
            <button class="previous-instruction hover-button" mat-mini-fab
              aria-label="previous instruction" (click)="onSwipeRight()"
              [disabled]="activeInstructionIndex() <= 0">
              <span class="material-symbols-outlined">keyboard_double_arrow_left</span>
            </button>
            <span class="instruction-counter">{{activeInstructionIndex()+1}}/{{instructions().length}}</span>
            <button  mat-mini-fab class="previous-instruction hover-button" aria-label="next instruction"
              (click)="onSwipeLeft()" [disabled]="activeInstructionIndex() >= instructions().length -1">
              <span class="material-symbols-outlined">keyboard_double_arrow_right</span>
            </button>
          </div>
        }
        <div class="result-actions">
          @if(displayedInstruction()?.type === InstructionType.Execute){
            @for (result of displayedInstruction()?.results; track result) {
              <button  mat-stroked-button
                type="button" (click)="onSelectResult(result)">
                {{ result.displayValue }}
              </button>
            }
          }
        </div>
      </mat-card-actions>
    </mat-card>
  </div>
} @else {
  <empty-state header="{{ TranslationConstants.VISUAL_INSTRUCTIONS.EMPTY_STATE_HEADER | translate }}"
  message="{{ TranslationConstants.VISUAL_INSTRUCTIONS.EMPTY_STATE_TEXT | translate }}" icon="bedtime"></empty-state>
}

