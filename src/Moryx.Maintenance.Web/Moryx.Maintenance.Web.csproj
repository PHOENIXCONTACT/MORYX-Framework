<Project Sdk="Microsoft.NET.Sdk.Razor" InitialTargets="BuildUI">
	<PropertyGroup>
		<TargetFramework>net10.0</TargetFramework>
		<Nullable>enable</Nullable>
		<ImplicitUsings>enable</ImplicitUsings>
		<AddRazorSupportForMvc>true</AddRazorSupportForMvc>
		<DefaultItemExcludes>src\**;node_modules\**;package\**</DefaultItemExcludes>
		<IsPackable>true</IsPackable>
	</PropertyGroup>
	<ItemGroup>
		<FrameworkReference Include="Microsoft.AspNetCore.App" />
	</ItemGroup>
	<ItemGroup>
		<ProjectReference Include="..\Moryx\Moryx.csproj" />
	</ItemGroup>
	<ItemGroup>
		<Content Remove="tsconfig*.json" />
		<Content Remove="package.json" />
		<Content Remove="package-lock.json" />
		<Content Remove="angular.json" />
		<Content Remove=".prettierrc.json; prettierrc.json" />
		<Content Remove="service-config.json" />
		<Content Update="@(Content)" Pack="false" />
		<Content Update="wwwroot\**" Pack="true" PackagePath="staticwebassets" />
	</ItemGroup>
	<ItemGroup>
		<Compile Update="Localizations\Strings.Designer.cs">
			<DesignTime>True</DesignTime>
			<AutoGen>True</AutoGen>
			<DependentUpon>Strings.resx</DependentUpon>
		</Compile>
	</ItemGroup>
	<ItemGroup>
		<EmbeddedResource Update="Localizations\Strings.resx">
			<Generator>PublicResXFileCodeGenerator</Generator>
			<LastGenOutput>Strings.Designer.cs</LastGenOutput>
		</EmbeddedResource>
	</ItemGroup>
	<Target Name="BuildUI"
		Condition="('$(Configuration)'!='Debug' Or !Exists('wwwroot\main.js')) And ('$(NoBuild)' != 'true') ">
		<Exec WorkingDirectory=".\" Command="npm config set strict-ssl false" />
		<Exec WorkingDirectory=".\" Command="npm install" />
		<Exec WorkingDirectory=".\" Command="npm run build:prod" />
		<Exec WorkingDirectory=".\" Command="npm config set strict-ssl true" />
	</Target>
</Project>